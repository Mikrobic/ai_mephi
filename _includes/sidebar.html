<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }} | {{ site.title }}</title>
  <link rel="stylesheet" href="{{ '/public/css/lanyon.css' | absolute_url }}">
  <link rel="stylesheet" href="{{ '/public/css/syntax.css' | absolute_url }}">
  <style>
    .sidebar {
      transition: transform 0.3s ease;
    }
    .sidebar-checkbox:checked ~ .sidebar {
      transform: translateX(0);
    }
    .sidebar-checkbox:not(:checked) ~ .sidebar {
      transform: translateX(-100%);
    }
  </style>
</head>

<body class="theme-base-0d">
  <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

  <div class="sidebar" id="sidebar">
    <div class="sidebar-item">
      <p>{{ site.description }}</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item{% if page.url == site.baseurl %} active{% endif %}" href="{{ site.baseurl }}/">Home</a>

      {% assign pages_list = site.pages | sort:"url" %}
      {% for node in pages_list %}
        {% if node.title != null %}
          {% if node.layout == "page" %}
            <a class="sidebar-nav-item{% if page.url == node.url %} active{% endif %}" href="{{ node.url }}">{{ node.title }}</a>
          {% endif %}
        {% endif %}
      {% endfor %}

      <div class="sidebar-item">
        <p>&copy; {{ site.time | date: '%Y' }}. All rights reserved.</p>
      </div>
    </nav>
  </div>

  <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  <script>
  (function(document) {
    const sidebarCheckbox = document.getElementById('sidebar-checkbox');
    const sidebarToggle = document.querySelector('.sidebar-toggle');
    const sidebar = document.getElementById('sidebar');

    // Restore sidebar state from localStorage
    if (localStorage.getItem('sidebarState') === 'open') {
      sidebarCheckbox.checked = true;
    }

    // Save state when changed
    sidebarCheckbox.addEventListener('change', function() {
      localStorage.setItem('sidebarState', this.checked ? 'open' : 'closed');
    });

    // Toggle sidebar function
    function toggleSidebar() {
      sidebarCheckbox.checked = !sidebarCheckbox.checked;
      sidebarCheckbox.dispatchEvent(new Event('change'));
    }

    // Handle hamburger click
    if (sidebarToggle) {
      sidebarToggle.addEventListener('click', function(e) {
        e.preventDefault();
        toggleSidebar();
      });
    }

    // Close sidebar when clicking outside
    document.addEventListener('click', function(e) {
      if (!sidebar.contains(e.target) && e.target !== sidebarToggle) {
        if (sidebarCheckbox.checked) {
          toggleSidebar();
        }
      }
    });

    // Close sidebar when clicking on nav items (except external links)
    document.querySelectorAll('.sidebar-nav-item').forEach(item => {
      item.addEventListener('click', function(e) {
        if (!this.hasAttribute('target') && 
            !this.href.startsWith('http') && 
            !this.href.startsWith('mailto') && 
            !this.href.startsWith('tel')) {
          if (sidebarCheckbox.checked) {
            setTimeout(toggleSidebar, 100); // Small delay for better UX
          }
        }
      });
    });
  })(document);
  </script>
</body>
</html>