<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
     <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

     <!-- Toggleable sidebar -->
     <div class="sidebar" id="sidebar">
       <div class="sidebar-item">
         <p>{{ site.description }}</p>
       </div>
     
       <nav class="sidebar-nav">
         <!-- Page order -->
         <a class="sidebar-nav-item" href="{{ site.baseurl }}/for_me/">Обо мне</a>
         <a class="sidebar-nav-item" href="{{ site.baseurl }}/stack/">Стек</a>
         <a class="sidebar-nav-item" href="{{ site.baseurl }}/career/">Карьерный трек</a>
     
         <!-- Nested project menu -->
         <div class="sidebar-nav-group{% if page.url contains '/project/' %} active{% endif %}">
           <a href="javascript:void(0)" class="sidebar-nav-item sidebar-nav-toggle{% if page.url contains '/project/' %} active{% endif %}">
             Проекты
             <svg class="toggle-icon" viewBox="0 0 24 24">
               <path d="M7 10l5 5 5-5z"/>
             </svg>
           </a>
           <div class="sidebar-submenu">
             <a href="{{ site.baseurl }}/project/subpage/" 
                class="sidebar-nav-item submenu-item{% if page.url == '/project/subpage/' %} active{% endif %}">
               Дашборд по учёту ёмкости ресурсов компании
             </a>
           </div>
         </div>
     
         <div class="sidebar-item">
           <p>
             &copy; {{ site.time | date: '%Y' }}. Тимакин Сергей.
           </p>
         </div>
       </nav>
     </div>
     
     <script>
     (function(document) {
       // Save sidebar state
       const sidebarCheckbox = document.getElementById('sidebar-checkbox');
       
       // Restore sidebar state
       if (localStorage.getItem('sidebarState') === 'open') {
         sidebarCheckbox.checked = true;
       }
     
       // Sidebar state change handler
       sidebarCheckbox.addEventListener('change', function() {
         localStorage.setItem('sidebarState', this.checked ? 'open' : 'closed');
       });
     
       // Original code for closing sidebar
       var sidebar = document.querySelector('#sidebar');
       const sidebarToggle = document.querySelector('.sidebar-toggle');
     
       // Close sidebar when clicking on it
       sidebar.addEventListener('click', function(e) {
         if (e.target === sidebar && sidebarCheckbox.checked) {
           sidebarCheckbox.checked = false;
           localStorage.setItem('sidebarState', 'closed');
           e.stopPropagation();
         }
       });
     
       if (sidebarToggle) {
         sidebarToggle.addEventListener('click', function(e) {
           e.preventDefault();
           sidebarCheckbox.checked = !sidebarCheckbox.checked;
           localStorage.setItem('sidebarState', sidebarCheckbox.checked ? 'open' : 'closed');
         });
       }
     
       document.addEventListener('click', function(e) {
         var target = e.target;
         if (!sidebarCheckbox.checked || sidebar.contains(target) || target === sidebarCheckbox) return;
         sidebarCheckbox.checked = false;
         localStorage.setItem('sidebarState', 'closed');
       });
     
       // Handlers for dropdown menus
       document.addEventListener('DOMContentLoaded', function() {
         const toggleButtons = document.querySelectorAll('.sidebar-nav-toggle');
         
         toggleButtons.forEach(button => {
           const group = button.closest('.sidebar-nav-group');
           
           // Restore menu state from localStorage
           const menuId = 'menu_' + group.querySelector('a').textContent.trim().toLowerCase();
           if (localStorage.getItem(menuId) === 'open') {
             group.classList.add('active');
           }
           
           button.addEventListener('click', function(e) {
             e.preventDefault();
             e.stopPropagation();
             group.classList.toggle('active');
             
             // Save menu state to localStorage
             const menuId = 'menu_' + group.querySelector('a').textContent.trim().toLowerCase();
             localStorage.setItem(menuId, group.classList.contains('active') ? 'open' : 'closed');
           });
         });
     
         // Automatically expand menu for active page
         const activeSubItem = document.querySelector('.sidebar-submenu .active');
         if (activeSubItem) {
           const parentGroup = activeSubItem.closest('.sidebar-nav-group');
           if (parentGroup) {
             parentGroup.classList.add('active');
             const menuId = 'menu_' + parentGroup.querySelector('a').textContent.trim().toLowerCase();
             localStorage.setItem(menuId, 'open');
           }
         }
       });
     })(document);
     </script>